async function handleLogin(supabase) {
  const form = document.getElementById('login-form');
  const errorMessage = document.getElementById('error-message');
  const successMessage = document.getElementById('success-message');

  form.addEventListener('submit', async (e) => {
    e.preventDefault(); // Prevent the default form submission

    // Get username, email, and password
    const username = document.getElementById('username').value.toLowerCase(); // Ensure lowercase username
    const email = document.getElementById('email').value;  // Not necessary if you're using username for login
    const password = document.getElementById('password').value;

    // Hide any previous messages
    errorMessage.style.display = 'none';
    successMessage.style.display = 'none';

    try {
      // Call your backend API to authenticate user using the username
      const response = await fetch('/api/login', { // Assuming you have an API endpoint '/api/login'
        method: 'POST',
        headers: { 'Content-Type': 'application/json' },
        body: JSON.stringify({ username: username, password: password })
      });

      const result = await response.json();

      if (result.error) {
        // If an error occurs (e.g., invalid credentials)
        errorMessage.style.display = 'block';
        errorMessage.textContent = 'Invalid credentials';
      } else {
        // If login is successful
        successMessage.style.display = 'block';
        console.log('User logged in:', result.user);

        // Redirect to the dashboard after 2 seconds
        setTimeout(() => {
          window.location.href = '/pages/dashboard';  // Redirect to the dashboard page
        }, 2000); // Wait 2 seconds to show the success message before redirect
      }
    } catch (error) {
      // Handle any other errors
      errorMessage.style.display = 'block';
      console.error('Error logging in:', error);
    }
  });
}
